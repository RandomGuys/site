<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xml:lang="fr" xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>2 Generation des clefs</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,2,sections+,charset=utf-8,html --> 
<meta name="src" content="rapport_Audit.tex" /> 
<meta name="date" content="2014-02-26 13:58:00" /> 
<link rel="stylesheet" type="text/css" href="rapport_Audit.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="rapport_Auditch5.html" >next</a>] [<a 
href="rapport_Auditch1.html" >prev</a>] [<a 
href="rapport_Auditch1.html#tailrapport_Auditch1.html" >prev-tail</a>] [<a 
href="#tailrapport_Auditch2.html">tail</a>] [<a 
href="rapport_Audit.html#rapport_Auditch4.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapitre&#x00A0;2</span><br /><a 
href="#x9-910002" id="x9-910002">Génération des clefs</a></h2>
<a 
 id="x9-91001r67"></a>
<h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
href="#x9-920001" id="x9-920001">Définitions et contexte</a></h3>
<a 
 id="x9-92001r97"></a>
<h4 class="subsectionHead"><span class="titlemark">2.1.1   </span> <a 
href="#x9-930001" id="x9-930001">Clefs cryptographiques</a></h4>
<!--l. 6--><p class="noindent" >La génération de clef est une notion fondamentale de cryptographie. En effet, les données sont protégées grâce à
des algorithmes (ou des méthodes cryptographiques) et des clefs cryptographiques. Les clefs cryptographiques sont
notamment utilisées pour le chiffrement et le déchiffrement de données. <br 
class="newline" />Relativement aux deux types de cryptographie, on compte deux types de clefs<span class="frenchb-nbsp">&nbsp;</span>: </p>
      <ul class="itemize1">
      <li class="itemize">les clefs symétriques pour le chiffrement symétrique<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">les clefs publiques/privées pour le chiffrement asymétriques.<br 
class="newline" /></li></ul>
<!--l. 13--><p class="indent" >   On se considérera dans ce chapitre dans un milieu optimal<span class="frenchb-nbsp">&nbsp;</span>:
      </p><ol  class="enumerate1" >
      <li 
  class="enumerate" id="x9-93002x1">l&#8217;algorithme cryptographique considéré est optimal<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li 
  class="enumerate" id="x9-93004x2">la génération de bits aléatoire est optimale.</li></ol>
<a 
 id="x9-93005r94"></a>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.1.1   </span> <a 
href="#x9-940001" id="x9-940001">Clefs d&#8217;algorithmes symétriques</a></h5>
<!--l. 21--><p class="noindent" >Les algorithmes symétriques utilisent pour leur chiffrement une clef symétrique qui est partagée par chacun des
correspondants.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                  

                                                                                                  
<a 
 id="x9-94001r1"></a>
                                                                                                  

                                                                                                  
<div class="center" 
>
<!--l. 24--><p class="noindent" >
</p><!--l. 43--><p class="noindent" >                                                                          </p><!--l. 34--><p class="noindent" ><span 
class="ec-lmbx-10x-x-109">Échange de messages par chiffrement sym</span><span 
class="ec-lmbx-10x-x-109">étrique</span>kkE (Alice)D (Bob)mm<span 
class="lmmi-10x-x-109">E</span><sub><span 
class="lmmi-8">k</span> </sub> <span 
class="rm-lmr-10x-x-109">(</span><span 
class="lmmi-10x-x-109">m</span><span 
class="rm-lmr-10x-x-109">) = </span><span 
class="lmmi-10x-x-109">c</span>
</p></div>
<br /> <div class="caption" 
><span class="id"><span 
class="ec-lmcsc-10x-x-109">Figure</span>&#x00A0;2.1: </span><span  
class="content">Chiffrement symétrique - Alice envoie un message <span 
class="lmmi-10x-x-109">c </span>chiffré à Bob qui le déchiffre</span></div><!--tex4ht:label?: x9-94001r1 -->
                                                                                                  

                                                                                                  
   </div><hr class="endfigure" />
<a 
 id="x9-94002r103"></a>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.1.2   </span> <a 
href="#x9-950002" id="x9-950002">Clefs d&#8217;algorithmes asymétriques</a></h5>
<!--l. 52--><p class="noindent" >Les clefs d&#8217;algorithmes symétriques sont de deux catégories, les clefs privées et les clef publiques. Les clefs
publiques sont disponibles pour tous, par demande à l&#8217;utilisateur, ou bien souvent par certificat.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                  

                                                                                                  
<a 
 id="x9-95001r2"></a><a 
 id="x9-101001r3"></a><a 
 id="x9-101005r11"></a>
                                                                                                  

                                                                                                  
<div class="center" 
>
<!--l. 55--><p class="noindent" >
</p><!--l. 77--><p class="noindent" >                                                                            </p><!--l. 68--><p class="noindent" ><span 
class="ec-lmbx-10x-x-109">Échange de messages par chiffrement asym</span><span 
class="ec-lmbx-10x-x-109">étrique</span><span 
class="lmmi-10x-x-109">k</span><sub><span 
class="lmmi-8">B</span> </sub> <span 
class="lmsy-10x-x-109">&#x2032;</span>E (Alice)D (Bob)mm<span 
class="lmmi-10x-x-109">k</span><sub><span 
class="lmmi-8">A</span> </sub> (publique), <span 
class="lmmi-10x-x-109">k</span><sub><span 
class="lmmi-8">A</span> </sub> <span 
class="lmsy-10x-x-109">&#x2032; </span>(privée)<span 
class="lmmi-10x-x-109">k</span><sub><span 
class="lmmi-8">B</span> </sub> (publique), <span 
class="lmmi-10x-x-109">k</span><sub><span 
class="lmmi-8">B</span> </sub> <span 
class="lmsy-10x-x-109">&#x2032; </span>(privée)<span 
class="lmmi-10x-x-109">E</span><sub><span 
class="lmmi-8">k</span><sub><span 
class="lmmi-6">B</span> </sub> </sub> <span 
class="rm-lmr-10x-x-109">(</span><span 
class="lmmi-10x-x-109">m</span><span 
class="rm-lmr-10x-x-109">) = </span><span 
class="lmmi-10x-x-109">c</span>
</p></div>
<br /> <div class="caption" 
><span class="id"><span 
class="ec-lmcsc-10x-x-109">Figure</span>&#x00A0;2.2: </span><span  
class="content">Chiffrement asymétrique - Alice envoie un message <span 
class="lmmi-10x-x-109">c </span>chiffré à Bob avec sa clef publique qui
le déchiffre</span></div><!--tex4ht:label?: x9-95001r2 -->
                                                                                                  

                                                                                                  
   </div><hr class="endfigure" />
<!--l. 83--><p class="indent" >   Comme montré en figure <a 
href="#x9-95001r2">2.2<!--tex4ht:ref: asym --></a>, Alice chiffre avec la clef publique de Bob un message, qui lui-même déchiffre le
message avec la clef privée.
<a 
 id="x9-95002r102"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark">2.1.2   </span> <a 
href="#x9-960002" id="x9-960002">Méthode de génération et sécurité</a></h4>
<!--l. 88--><p class="noindent" >Les systèmes utilisent des entiers comme clef. Celles-ci sont générées en utilisant des générateurs de nombres
aléatoires (RNG) ou des générateurs de nombres pseudo aléatoires (PRNG).
<a 
 id="x9-96001r105"></a>
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.2.1   </span> <a 
href="#x9-970001" id="x9-970001">Génération de clefs quelconques</a></h5>
<!--l. 91--><p class="noindent" >Un générateur de bits aléatoires (RGB) approuvé est utilisé pour générer la clef cryptographique. Le RGB doit
fournir une entropie complète ou suffisante aux exigences de sécurité du système. Les RGB peuvent permettre de
générer complètement et "directement" la clef. C&#8217;est le cas pour les clefs privées des algorithmes AES ou DSA. Les
RGB peuvent aussi être utilisés comme <span 
class="ec-lmri-10x-x-109">seed </span>pour générer des clefs, suivants des critères spécifiques. C&#8217;est le cas
pour RSA, où habituellement le <span 
class="ec-lmri-10x-x-109">seed </span>est utilisé comme point de départ pour trouver un nombre premier suivant les
critères du FIPS 186-3 <span class="cite">[<a 
href="rapport_Auditli5.html#Xfips186-3">71</a>]</span>.
<a 
 id="x9-97001r108"></a>
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.2.2   </span> <a 
href="#x9-980002" id="x9-980002">Génération de paires de clefs asymétriques</a></h5>
<!--l. 95--><p class="noindent" >Les algorithmes asymétriques demandent la création de paires de clefs asymétriques (privée/publique), dont
chaque clef est associée à une seule entité, le possesseur de la clef. Les clefs sont généralement générées
par son possesseur direct, ou par une autorité de confiance qui fournit la clef au possesseur de façon
sûre.<br 
class="newline" />Il convient au moment de la génération de bien considérer deux paramètres principaux<span class="frenchb-nbsp">&nbsp;</span>:
      </p><ol  class="enumerate1" >
      <li 
  class="enumerate" id="x9-98002x1">l&#8217;espace de clefs, qui doit être suffisamment grand pour éviter les doublons et les cycles<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li 
  class="enumerate" id="x9-98004x2">Générer les premiers de façon la plus aléatoire possible. Ceci nécessite un bon choix de stratégie
      d&#8217;identification de premiers. On peut par exemple utiliser des algorithmes permettant de détecter le
      prochain premier, suivant un entier tiré aléatoirement.</li></ol>
<a 
 id="x9-98005r101"></a>
<h3 class="sectionHead"><span class="titlemark">2.2   </span> <a 
href="#x9-990002" id="x9-990002">Audits</a></h3>
<a 
 id="x9-99001r107"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.1   </span> <a 
href="#x9-1000001" id="x9-1000001">Audit 2.1<span class="frenchb-nbsp">&nbsp;</span>: Génération d&#8217;entiers premiers, et de grands nombres</a></h4>
<a 
 id="x9-100001r109"></a>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.1.1   </span> <a 
href="#x9-1010001" id="x9-1010001">Description de la librairie BIGNUMBER</a></h5>
<!--l. 109--><p class="noindent" >OpenSSL gère l&#8217;arithmétique multi-précison (gestion des grands entier) avec sa librairie BIGNUMBER.
La taille de ces entiers est arbitraire, il n&#8217;y a théoriquement pas de limitation de taille. Elle a été
spécialement créée afin d&#8217;utiliser des systèmes cryptographiques à clefs publiques tels que RSA ou
Diffie-Hellman.<br 
class="newline" />
</p><!--l. 111--><p class="indent" >   Pour le stockage de grands entiers, elle utilise directement et dynamiquement la mémoire comme structure de
données. Le code de retour est un entier permettant de vérifier l&#8217;état de la mémoire après chaque
opération.<br 
class="newline" />
</p><!--l. 113--><p class="indent" >   Le type de données pour ces grands entiers est une structure ayant pour nom BIGNUM. Cette structure peut
être directement utilisée en incluant la bibliothèque <span 
class="ec-lmtt-10x-x-109">openssl/crypto/bn/bn.h</span>.<br 
class="newline" />
</p><!--l. 115--><p class="indent" >   La structure générale d&#8217;un BIGNUM est définie dans le fichier <span 
class="ec-lmtt-10x-x-109">openssl/crypto/ossl_typ.h</span>, (cf. <span 
class="ec-lmri-10x-x-109">Listing </span><a 
href="#x9-101001r1">2.1<!--tex4ht:ref: ossltyp --></a>),
et elle est implantée dans le fichier <span 
class="ec-lmtt-10x-x-109">openssl/crypto/bn/bn.h </span>(cf. <span 
class="ec-lmri-10x-x-109">Listing </span><a 
href="#x9-101005r2">2.2<!--tex4ht:ref: bn --></a>). Un schéma explicatif est défini sur
<span 
class="ec-lmri-10x-x-109">Listing </span><a 
href="#x9-101017r3">2.3<!--tex4ht:ref: bignum --></a>.
</p>
   <!--l. 117-->
<a 
 id="x9-101001r1"></a>
<a 
 id="x9-101002"></a>
   <div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x9-101003r1"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">typedef</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">struct</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">bignum_st</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">BIGNUM</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101004r2"></a><span 
class="ec-lmr-6">2</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span>
   
   <br />
       <div class="caption" 
><span class="id">Listing&#x00A0;2.1:
       </span><span  
class="content">ossl_typ.h</span></div><!--tex4ht:label?: x9-101001r2 -->
   </div>
   <!--l. 121-->
<a 
 id="x9-101005r2"></a>
<a 
 id="x9-101006"></a>
   <div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x9-101007r1"></a><span 
class="ec-lmr-6">1</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">struct</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">bignum_st</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101008r2"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">{</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101009r3"></a><span 
class="ec-lmr-6">3</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">BN_ULONG</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">*</span><span 
class="ec-lmtt-9">d</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">/*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">Pointer</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">to</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">an</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">array</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">of</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#8217;</span><span 
class="ec-lmtti-10x-x-90">BN_BITS2</span><span 
class="ec-lmtti-10x-x-90">&#8217;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">bit</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">chunks</span><span 
class="ec-lmtti-10x-x-90">.</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*/</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101010r4"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">int</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">top</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">/*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">Index</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">of</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">last</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">used</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">d</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">+1.</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*/</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101011r5"></a><span 
class="ec-lmr-6">5</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">/*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">The</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">next</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">are</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">internal</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">book</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">keeping</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">for</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">bn_expand</span><span 
class="ec-lmtti-10x-x-90">.</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*/</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101012r6"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">int</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">dmax</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">/*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">Size</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">of</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">the</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">d</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">array</span><span 
class="ec-lmtti-10x-x-90">.</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*/</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101013r7"></a><span 
class="ec-lmr-6">7</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">int</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">neg</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">/*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">one</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">if</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">the</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">number</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">is</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">negative</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*/</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101014r8"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">int</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">flags</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101015r9"></a><span 
class="ec-lmr-6">9</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">};</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101016r10"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span>
   
   <br />
       <div class="caption" 
><span class="id">Listing&#x00A0;2.2:
       </span><span  
class="content">bn.h</span></div><!--tex4ht:label?: x9-101005r2 -->
   </div>
   <hr class="figure" /><div class="figure" 
>
                                                                                                  

                                                                                                  
<a 
 id="x9-101017r3"></a><a 
 id="x9-101018r20"></a><a 
 id="x9-115001r39"></a><a 
 id="x9-122001r8"></a>
                                                                                                  

                                                                                                  
<div class="center" 
>
<!--l. 134--><p class="noindent" >
</p><!--l. 166--><p class="noindent" >                                                                            </p><!--l. 154--><p class="noindent" ><span 
class="ec-lmbx-10x-x-109">Structure d&#8217;un big number</span>d.d[0]d[1]d[max]8 octetsnegnégatif, si vaut 1positif, sinontopposition courante+1
</p></div>
<br /> <div class="caption" 
><span class="id"><span 
class="ec-lmcsc-10x-x-109">Figure</span>&#x00A0;2.3: </span><span  
class="content">Structure d&#8217;un BIGNUM</span></div><!--tex4ht:label?: x9-101017r3 -->
                                                                                                  

                                                                                                  
   </div><hr class="endfigure" />
<!--l. 172--><p class="indent" >   Il existe des structures variantes de BIGNUM pour d&#8217;autres cas d&#8217;utilisation (Montgomery, Division réciproque,
génération lente).<br 
class="newline" />
</p><!--l. 174--><p class="indent" >   La création d&#8217;une nouvelle structure de type BIGNUM se situe dans le fichier <span 
class="ec-lmtt-10x-x-109">openssl/crypto/bn/bn_lib.h</span>, la
fonction se nomme <span 
class="ec-lmtt-10x-x-109">BN_new() </span>(cf. <span 
class="ec-lmri-10x-x-109">Listing </span><a 
href="#x9-101018r3">2.3<!--tex4ht:ref: bnlib --></a>).<br 
class="newline" />
</p>
   <!--l. 176-->
<a 
 id="x9-101018r3"></a>
<a 
 id="x9-101019"></a>
   <div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x9-101020r1"></a><span 
class="ec-lmr-6">1</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101021r2"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">BIGNUM</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">*</span><span 
class="ec-lmtt-9">BN_new</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtk-10x-x-90">void</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101022r3"></a><span 
class="ec-lmr-6">3</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">{</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101023r4"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">BIGNUM</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">*</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101024r5"></a><span 
class="ec-lmr-6">5</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101025r6"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">((</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">=(</span><span 
class="ec-lmtt-9">BIGNUM</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">*)</span><span 
class="ec-lmtt-9">OPENSSL_malloc</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtk-10x-x-90">sizeof</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">BIGNUM</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">==</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">NULL</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101026r7"></a><span 
class="ec-lmr-6">7</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">{</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101027r8"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">BNerr</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">BN_F_BN_NEW</span><span 
class="ec-lmtt-9">,</span><span 
class="ec-lmtt-9">ERR_R_MALLOC_FAILURE</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101028r9"></a><span 
class="ec-lmr-6">9</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">return</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">NULL</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101029r10"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">}</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101030r11"></a><span 
class="ec-lmr-6">11</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">-&#x003E;</span><span 
class="ec-lmtt-9">flags</span><span 
class="ec-lmtt-9">=</span><span 
class="ec-lmtt-9">BN_FLG_MALLOCED</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101031r12"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">-&#x003E;</span><span 
class="ec-lmtt-9">top</span><span 
class="ec-lmtt-9">=0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101032r13"></a><span 
class="ec-lmr-6">13</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">-&#x003E;</span><span 
class="ec-lmtt-9">neg</span><span 
class="ec-lmtt-9">=0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101033r14"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">-&#x003E;</span><span 
class="ec-lmtt-9">dmax</span><span 
class="ec-lmtt-9">=0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101034r15"></a><span 
class="ec-lmr-6">15</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">-&#x003E;</span><span 
class="ec-lmtt-9">d</span><span 
class="ec-lmtt-9">=</span><span 
class="ec-lmtt-9">NULL</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101035r16"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">bn_check_top</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101036r17"></a><span 
class="ec-lmr-6">17</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">return</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">ret</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101037r18"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">}</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-101038r19"></a><span 
class="ec-lmr-6">19</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span>
   
   <br />
       <div class="caption" 
><span class="id">Listing&#x00A0;2.3:
       </span><span  
class="content">bn_lib.c</span></div><!--tex4ht:label?: x9-101018r2 -->
   </div>
<a 
 id="x9-101039r112"></a>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.1.2   </span> <a 
href="#x9-1020002" id="x9-1020002">Normes visées</a></h5>
<!--l. 199--><p class="noindent" >Plusieurs fonctions désignent directement la norme visée, voici quelques exemples sur les thèmes nous concernant
pour l&#8217;audit.<br 
class="newline" />Sur la génération de groupes d&#8217;exponentiation modulaire de Diffie-Hellman allant de 768bits à 8192bits, les RFC
visées <span class="cite">[<a 
href="rapport_Auditli5.html#Xrfc2409">27</a>]</span> <span class="cite">[<a 
href="rapport_Auditli5.html#Xrfc3526">33</a>]</span> ont leurs fonctions implantées dans le code<span class="frenchb-nbsp">&nbsp;</span>: </p>
      <ul class="itemize1">
      <li class="itemize">BIGNUM *get_rfc2409_prime_768(BIGNUM *bn)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">BIGNUM *get_rfc2409_prime_1024(BIGNUM *bn)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">BIGNUM *get_rfc3526_prime_1536(BIGNUM *bn)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">BIGNUM *get_rfc3526_prime_2048(BIGNUM *bn)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">BIGNUM *get_rfc3526_prime_3072(BIGNUM *bn)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">BIGNUM *get_rfc3526_prime_4096(BIGNUM *bn)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">BIGNUM *get_rfc3526_prime_6144(BIGNUM *bn)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">BIGNUM *get_rfc3526_prime_8192(BIGNUM *bn)<span class="frenchb-thinspace">&nbsp;</span>;</li></ul>
<!--l. 212--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1030002" id="x9-1030002"><span 
class="ec-lmbx-10x-x-109">RFC 2409</span><span class="frenchb-nbsp">&nbsp;</span><span 
class="ec-lmbx-10x-x-109">: Internet Key Exchange</span><br 
class="newline" /></a></span>
   La RFC 2409 <span class="cite">[<a 
href="rapport_Auditli5.html#Xrfc2409">27</a>]</span> datant de 1998, donne deux implantations de fonctions récupérant des entiers premiers de
plus de 768bits et de plus de 1024bits. Elles se nomment respectivement le premier groupe d&#8217;Oakley et le second
                                                                                                  

                                                                                                  
groupe d&#8217;Oakley.<br 
class="newline" />
</p><!--l. 216--><p class="indent" >   Un groupe MODP (Modular exponentiation group) est un groupe d&#8217;exponentiation modulaire.
<br 
class="newline" />
</p><!--l. 218--><p class="indent" >   Pour le groupe MODP sur 768bits (groupe par défaut qui DOIT être le minimum requis) le groupe utilise
comme nombre premier<span class="frenchb-nbsp">&nbsp;</span>:
</p>
   <center class="math-display" >
<img 
src="rapport_Audit44x.png" alt=" 768   704       64     638
2   - 2   -  1+ 2  * {[2    pi] + 149686} " class="math-display"  /></center> Et
comme générateur<span class="frenchb-nbsp">&nbsp;</span>: 2.<br 
class="newline" />
<!--l. 222--><p class="indent" >   Pour le groupe MODP sur 1024bits (groupe alternatif qui DEVRAIT être le groupe utilisé) le groupe utilise
comme nombre premier<span class="frenchb-nbsp">&nbsp;</span>:
</p>
   <center class="math-display" >
<img 
src="rapport_Audit45x.png" alt="21024 - 2960 - 1+  264 *{[2894 pi]+ 129093} " class="math-display"  /></center> Et
comme générateur<span class="frenchb-nbsp">&nbsp;</span>: 2. <br 
class="newline" />
<!--l. 226--><p class="indent" >   La RFC 2412<span class="frenchb-nbsp">&nbsp;</span>: OAKLEY Key Determination Protocol datant de 1998 également <span class="cite">[<a 
href="rapport_Auditli5.html#Xrfc2412">51</a>]</span> préconise plutôt d&#8217;utiliser
22 comme générateur.
</p>
<!--l. 228--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1040002" id="x9-1040002"><span 
class="ec-lmbx-10x-x-109">RFC 3526</span><span class="frenchb-nbsp">&nbsp;</span><span 
class="ec-lmbx-10x-x-109">: More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange</span>
<span 
class="ec-lmbx-10x-x-109">(IKE)</span><br 
class="newline" /></a></span>
   La RFC 3526 <span class="cite">[<a 
href="rapport_Auditli5.html#Xrfc3526">33</a>]</span> complète la RFC 2409. Elle définit les groupes MODP sur 1536, 2048, 3072, 4096, 6144 et
8192 bits.<br 
class="newline" />
                                                                                                  

                                                                                                  
</p><!--l. 232--><p class="indent" >   <span 
class="ec-lmri-10x-x-109">Exemple avec 2048 bits</span><span class="frenchb-nbsp">&nbsp;</span><span 
class="ec-lmri-10x-x-109">:</span><br 
class="newline" />Le nombre premier vaut<span class="frenchb-nbsp">&nbsp;</span>:
</p>
   <center class="math-display" >
<img 
src="rapport_Audit46x.png" alt=" 2048   1984        64     1918
2    - 2    - 1+  2  *{[2    pi]+ 124476} " class="math-display"  /></center> Le
générateur vaut<span class="frenchb-nbsp">&nbsp;</span>: 2<br 
class="newline" />
<!--l. 237--><p class="indent" >   Sur la génération de nombres premiers, nous nous basons sur la RFC 2631 qui utilise les recommandations du
FIPS 140-1 que l&#8217;on défini dans la section <span 
class="ec-lmbx-10x-x-109">??</span>
<a 
 id="x9-104001r117"></a>
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.1.3   </span> <a 
href="#x9-1050003" id="x9-1050003">Implémentation</a></h5>
<!--l. 241--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1060003" id="x9-1060003"><span 
class="ec-lmbx-10x-x-109">Version vis</span><span 
class="ec-lmbx-10x-x-109">ée. </span><br 
class="newline" /></a></span>
   La version auditée est OpenSSL 1.0.0l sortie le 6 Janvier 2014.
</p>
<!--l. 245--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1070003" id="x9-1070003"><span 
class="ec-lmbx-10x-x-109">Exemples de fonctions. </span><br 
class="newline" /></a></span>
   Les fichiers <span 
class="ec-lmtt-10x-x-109">bn_add.c</span>, <span 
class="ec-lmtt-10x-x-109">bn_exp.c</span>, <span 
class="ec-lmtt-10x-x-109">bn_div.c</span>, <span 
class="ec-lmtt-10x-x-109">bn_mul.c</span>, etc, présents dans le paquetage <span 
class="ec-lmtt-10x-x-109">openssl/crypto/bn</span>
contiennent des fonctions arithmétiques simples (addition, multiplication, soustraction, exponentiaition, etc)
utilisant la structure BIGNUM.
</p>
<!--l. 249--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1080003" id="x9-1080003"><span 
class="ec-lmbx-10x-x-109">Analyse de la g</span><span 
class="ec-lmbx-10x-x-109">én</span><span 
class="ec-lmbx-10x-x-109">ération d&#8217;entiers premiers.</span><br 
class="newline" /></a></span>
   La génération des entiers premiers se fait au sein du fichier <span 
class="ec-lmtt-10x-x-109">openssl/crypto/bn/bn_prime.c</span>. Parmi les
fonctions intéressantes nous avons<span class="frenchb-nbsp">&nbsp;</span>: </p>
      <ul class="itemize1">
      <li class="itemize">int BN_generate_prime_ex(BIGNUM *ret, int bits, int safe, const BIGNUM *add, const BIGNUM
      *rem, BN_GENCB *cb)<span class="frenchb-thinspace">&nbsp;</span>;
                                                                                                  

                                                                                                  
      </li>
      <li class="itemize">int BN_is_prime_ex(const BIGNUM *p,int nchecks, BN_CTX *ctx, BN_GENCB *cb)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">int BN_is_prime_fasttest_ex(const BIGNUM *p,int nchecks, BN_CTX *ctx, int do_trial_division,
      BN_GENCB *cb)<span class="frenchb-thinspace">&nbsp;</span>;<br 
class="newline" /></li></ul>
<!--l. 258--><p class="indent" >   <span 
class="ec-lmri-10x-x-109">int BN_generate_prime_ex(BIGNUM *ret, int bits, int safe, const BIGNUM *add, const BIGNUM *rem,</span>
<span 
class="ec-lmri-10x-x-109">BN_GENCB *cb)</span><span class="frenchb-thinspace">&nbsp;</span><span 
class="ec-lmri-10x-x-109">;</span> </p>
      <ul class="itemize1">
      <li class="itemize">génère un nombre premier aléatoire de <span 
class="ec-lmri-10x-x-109">bits </span>bits<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">si <span 
class="ec-lmri-10x-x-109">ret </span>vaut <span 
class="lmmi-10x-x-109">NULL </span>alors l&#8217;entier n&#8217;est pas stocké, sinon il est stocké sur le descripteur de la structure
      BIGNUM<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">si <span 
class="ec-lmri-10x-x-109">cb </span>n&#8217;est pas <span 
class="lmmi-10x-x-109">NULL </span>il servira à générer un <span 
class="ec-lmri-10x-x-109">callback </span>lors de la génération du i-ème nombre premier
      potentiel, lors du test de primalité et lorsqu&#8217;un entier premier à été trouvé<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">d&#8217;après la RFC 2631 <span class="cite">[<a 
href="rapport_Auditli5.html#Xrfc2631">55</a>]</span> et en particulier les parties concernant le FIPS 186-1 <span class="cite">[<a 
href="rapport_Auditli5.html#Xfips186-1">69</a>]</span>, le paramètre
      <span 
class="ec-lmri-10x-x-109">add </span>permet de vérifier la condition<span class="frenchb-nbsp">&nbsp;</span>: <span 
class="lmmi-10x-x-109">pmodadd </span><span 
class="rm-lmr-10x-x-109">== </span><span 
class="lmmi-10x-x-109">rem</span><span 
class="lmsy-10x-x-109">||</span><span 
class="lmmi-10x-x-109">pmodadd </span><span 
class="rm-lmr-10x-x-109">== 1</span><span 
class="lmmi-10x-x-109">&#x00A0;Si</span><span 
class="lmmi-10x-x-109">&#x00A0;rem </span><span 
class="rm-lmr-10x-x-109">== </span><span 
class="lmmi-10x-x-109">NULL</span><span 
class="rm-lmr-10x-x-109">) </span>et le
      paramètre <span 
class="ec-lmri-10x-x-109">safe </span>vaut <span 
class="ec-lmri-10x-x-109">true </span>pour la définition d&#8217;un nombre premier sûr, e.g qu&#8217;il résiste à certaines
      attaques cryptanalytiques (i.e un entier premier p dont <span 
class="rm-lmr-10x-x-109">(</span><span 
class="lmmi-10x-x-109">p </span><span 
class="lmsy-10x-x-109">- </span><span 
class="rm-lmr-10x-x-109">1)</span><span 
class="lmmi-10x-x-109">&#x2215;</span><span 
class="rm-lmr-10x-x-109">2 </span>est également premier est sûr)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">attention avant d&#8217;utiliser la fonction ci-dessus à bien passer une graine au PRNG<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">la génération d&#8217;un nombre premier a une probabilité d&#8217;échec négligeable (0.25% d&#8217;échecs possibles
      puissance le nombre de tentatives)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">la fonction retourne &#8217;1&#8217; si la génération est un succès, &#8217;0&#8217; sinon.<br 
class="newline" /></li></ul>
<!--l. 269--><p class="indent" >   <span 
class="ec-lmri-10x-x-109">int BN_prime_ex(const BIGNUM *p,int nchecks, BN_CTX *ctx, BN_GENCB *cb)</span><span class="frenchb-thinspace">&nbsp;</span><span 
class="ec-lmri-10x-x-109">;</span> </p>
      <ul class="itemize1">
      <li class="itemize">fonction de test de primalité sur l&#8217;entier <span 
class="ec-lmri-10x-x-109">p</span><span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">nbchecks est le nombre de tests à effectuer<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize"><span 
class="ec-lmri-10x-x-109">cb </span>s&#8217;il n&#8217;est pas <span 
class="lmmi-10x-x-109">NULL </span>génère un callback à chaque j-ème itération dans le code<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize"><span 
class="ec-lmri-10x-x-109">ctx </span>s&#8217;il n&#8217;est pas <span 
class="lmmi-10x-x-109">NULL </span>est utilisé pour sauvegarder l&#8217;allocation du dessus et libérer la structure<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">la fonction retourne 0 si le nombre est premier avec une probabilité de 100%, 1 si la probabilité est
      plus faible que <span 
class="rm-lmr-10x-x-109">0</span><span 
class="lmmi-10x-x-109">.</span><span 
class="rm-lmr-10x-x-109">25</span><sup><span 
class="lmmi-8">n</span></sup><span 
class="lmmi-10x-x-109">checks</span>, et -1 sinon.<br 
class="newline" /></li></ul>
<!--l. 278--><p class="indent" >   <span 
class="ec-lmri-10x-x-109">int BN_is_prime_fasttest_ex(const BIGNUM *p,int nchecks, BN_CTX *ctx, int do_trial_division,</span>
<span 
class="ec-lmri-10x-x-109">BN_GENCB *cb)</span><span class="frenchb-thinspace">&nbsp;</span><span 
class="ec-lmri-10x-x-109">;</span> </p>
      <ul class="itemize1">
                                                                                                  

                                                                                                  
      <li class="itemize">cette fonction fait exactement la même chose que la fonction précédente<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">mais si <span 
class="ec-lmri-10x-x-109">do_trial_division </span>vaut &#8217;1&#8217; il testera avant s&#8217;il n&#8217;est pas divisible par des petits nombres entiers,
      s&#8217;il vaut &#8217;0&#8217; cela revient à appeler la fonction <span 
class="ec-lmri-10x-x-109">BN_prime_ex</span></li></ul>
<a 
 id="x9-108001r120"></a>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.1.4   </span> <a 
href="#x9-1090004" id="x9-1090004">Conclusion</a></h5>
     Sur la présentation des différentes structures et des différentes opérations arithmétiques revisitées, la
documentation est plus complète et plus claire que les autres fonctions auditées en général, même s&#8217;il reste à
notre avis des efforts sur la mise en forme. Le découpage des fonctions est bien fait au sein du dossier
<span 
class="ec-lmtt-10x-x-109">openssl/crypto/bn </span>avec des noms de fichiers cohérents, et au sein des fichiers avec des explications sur les
différentes structures et des noms de fonctions cohérentes également même si on aurait préféré une ligne
d&#8217;explications en en-tête de chaque fonction. Lors de l&#8217;audit, on retrouvait rapidement le code concernant une
fonction.<br 
class="newline" />
   Sur le contenu, les normes sont bien respectées, notamment pour la génération des nombres premiers qui utilise
les tests de primalité de Miller-Rabin, réputés sûrs.
<a 
 id="x9-109001r111"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.2   </span> <a 
href="#x9-1100002" id="x9-1100002">Audit 2.2<span class="frenchb-nbsp">&nbsp;</span>: Le générateur de Diffie-Hellman</a></h4>
<a 
 id="x9-110001r124"></a>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.2.1   </span> <a 
href="#x9-1110001" id="x9-1110001">Normes visées</a></h5>
<!--l. 295--><p class="noindent" >Voici l&#8217;algorithme de génération de g, d&#8217;après la RFC 2631 <span class="cite">[<a 
href="rapport_Auditli5.html#Xrfc2631">55</a>]</span> datant de 1999 et dérivé de la FIPS-186<span class="frenchb-nbsp">&nbsp;</span>:
</p>
      <ul class="itemize1">
      <li class="itemize">1- Soit <span 
class="lmmi-10x-x-109">j </span><span 
class="rm-lmr-10x-x-109">= (</span><span 
class="lmmi-10x-x-109">p </span><span 
class="lmsy-10x-x-109">- </span><span 
class="rm-lmr-10x-x-109">1)</span><span 
class="lmmi-10x-x-109">&#x2215;q</span>.
      </li>
      <li class="itemize">2- Choisir <span 
class="lmmi-10x-x-109">h </span><span 
class="lmsy-10x-x-109">&#x2208; </span><span 
class="msbm-10x-x-109">&#x2115;</span>, tel que <span 
class="rm-lmr-10x-x-109">1 </span><span 
class="lmmi-10x-x-109">&#x003C; h &#x003C; p </span><span 
class="lmsy-10x-x-109">- </span><span 
class="rm-lmr-10x-x-109">1</span>
      </li>
      <li class="itemize">3- Calculer <span 
class="lmmi-10x-x-109">g </span><span 
class="rm-lmr-10x-x-109">= </span><span 
class="lmmi-10x-x-109">h</span><sup><span 
class="lmmi-8">j</span></sup>  <span 
class="rm-lmr-10x-x-109">mod</span><span style="margin-left:0.3em" class="thinspace"></span><span style="margin-left:0.3em" class="thinspace"></span><span 
class="lmmi-10x-x-109">p</span>
      </li>
      <li class="itemize">4- Si <span 
class="lmmi-10x-x-109">g </span><span 
class="rm-lmr-10x-x-109">= 1 </span>recommencer l&#8217;étape 2<br 
class="newline" /></li></ul>
<!--l. 303--><p class="indent" >   Mais depuis 2006, on peut lire comme recommandation dans la RFC 4419 (pour une utilisation SSH)<span class="frenchb-nbsp">&nbsp;</span>: "<span 
class="ec-lmri-10x-x-109">It is</span>
<span 
class="ec-lmri-10x-x-109">recommended to use 2 as generator, because it improves efficiency in multiplication performance. It is usable even</span>
<span 
class="ec-lmri-10x-x-109">when itis not a primitive root, as it still covers half of the space of possible residues.</span>"<br 
class="newline" />
<a 
 id="x9-111001r126"></a>
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.2.2   </span> <a 
href="#x9-1120002" id="x9-1120002">Description de la faille</a></h5>
<!--l. 307--><p class="noindent" >Lorsque nous avons étudié le code de Diffie-Hellman dans OpenSSL, nous nous sommes penchés sur un choix plutôt
étrange. La valeur du générateur est toujours fixé à 2 ou à 5. <br 
class="newline" />
                                                                                                  

                                                                                                  
</p><!--l. 309--><p class="indent" >   Le générateur de Diffie-Hellman n&#8217;étant pas une racine primitive dans <span 
class="msbm-10x-x-109">&#x2124;</span><span 
class="lmmi-10x-x-109">&#x2215;</span><span 
class="msbm-10x-x-109">&#x2124;</span><sub><span 
class="lmmi-8">p</span></sub>, les conséquences sont<span class="frenchb-nbsp">&nbsp;</span>:
</p>
      <ul class="itemize1">
      <li class="itemize">l&#8217;espace des clefs possibles est fortement réduit (Si <span 
class="lmmi-10x-x-109">g </span><span 
class="rm-lmr-10x-x-109">= 2</span><span style="margin-left:3.04074pt" class="tmspace"></span><img 
src="rapport_Audit47x.png" alt="=&#x21D2;"  class="Longrightarrow"  /><span style="margin-left:3.04074pt" class="tmspace"></span> espace divisé par deux)<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">deux clefs privées distinctes pourront avoir une clef publique commune<span class="frenchb-thinspace">&nbsp;</span>;
      </li>
      <li class="itemize">la méthode de cryptanalyse Baby-step Giant-step peut s&#8217;en trouver facilité.<br 
class="newline" /></li></ul>
<!--l. 316--><p class="indent" >   Évidemment, ce choix n&#8217;est pas une faille en soit, il n&#8217;est juste pas optimal et résulte d&#8217;un bon compromis
entre vitesse et sécurité. Pour une sécurité optimale, il est conseillé de choisir un générateur qui soit
une racine primitive, pour être certain que personne ne puisse signer, déchiffrer des messages à votre
place<span class="frenchb-thinspace">&nbsp;</span>!<br 
class="newline" />
<a 
 id="x9-112001r127"></a>
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.2.3   </span> <a 
href="#x9-1130003" id="x9-1130003">Implémentation</a></h5>
<!--l. 321--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1140003" id="x9-1140003"><span 
class="ec-lmbx-10x-x-109">Configuration vis</span><span 
class="ec-lmbx-10x-x-109">ée.</span><br 
class="newline" /></a></span>
   La version actuelle d&#8217;OpenSSL<span class="frenchb-nbsp">&nbsp;</span>: 1.1.0
</p>
<!--l. 325--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1150003" id="x9-1150003"><span 
class="ec-lmbx-10x-x-109">Fonction.</span><br 
class="newline" /></a></span>
   La fonction liée à cette norme est accessible sous le paquetage <span 
class="ec-lmtt-10x-x-109">openssl/crypto/dh/dh_gen.c </span>(cf. <span 
class="ec-lmri-10x-x-109">Listing </span><a 
href="#x9-115001r4">2.4<!--tex4ht:ref: dhgen --></a>).
Les commentaires sont très intéressants pour comprendre le choix du générateur par l&#8217;équipe de
développement.
</p>
   <!--l. 329-->
<a 
 id="x9-115001r4"></a>
<a 
 id="x9-115002"></a>
   <div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x9-115003r1"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">generator</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x003C;=</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">1)</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115004r2"></a><span 
class="ec-lmr-6">2</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">{</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115005r3"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">DHerr</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">DH_F_DH_BUILTIN_GENPARAMS</span><span 
class="ec-lmtt-9">,</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">DH_R_BAD_GENERATOR</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115006r4"></a><span 
class="ec-lmr-6">4</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115007r5"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">}</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115008r6"></a><span 
class="ec-lmr-6">6</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">generator</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">==</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">DH_GENERATOR_2</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115009r7"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">{</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115010r8"></a><span 
class="ec-lmr-6">8</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(!</span><span 
class="ec-lmtt-9">BN_set_word</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">t1</span><span 
class="ec-lmtt-9">,24)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115011r9"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(!</span><span 
class="ec-lmtt-9">BN_set_word</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">t2</span><span 
class="ec-lmtt-9">,11)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115012r10"></a><span 
class="ec-lmr-6">10</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">g</span><span 
class="ec-lmtt-9">=2;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115013r11"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">}</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115014r12"></a><span 
class="ec-lmr-6">12</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">#</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">0</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">/*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">does</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">not</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">work</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">for</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">safe</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">primes</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*/</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115015r13"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">else</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">generator</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">==</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">DH_GENERATOR_3</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115016r14"></a><span 
class="ec-lmr-6">14</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">{</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115017r15"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(!</span><span 
class="ec-lmtt-9">BN_set_word</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">t1</span><span 
class="ec-lmtt-9">,12)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115018r16"></a><span 
class="ec-lmr-6">16</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(!</span><span 
class="ec-lmtt-9">BN_set_word</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">t2</span><span 
class="ec-lmtt-9">,5)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115019r17"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">g</span><span 
class="ec-lmtt-9">=3;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115020r18"></a><span 
class="ec-lmr-6">18</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">}</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115021r19"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">#</span><span 
class="ec-lmtk-10x-x-90">endif</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115022r20"></a><span 
class="ec-lmr-6">20</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">else</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">generator</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">==</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">DH_GENERATOR_5</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115023r21"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">{</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115024r22"></a><span 
class="ec-lmr-6">22</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(!</span><span 
class="ec-lmtt-9">BN_set_word</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">t1</span><span 
class="ec-lmtt-9">,10)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115025r23"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(!</span><span 
class="ec-lmtt-9">BN_set_word</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">t2</span><span 
class="ec-lmtt-9">,3)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115026r24"></a><span 
class="ec-lmr-6">24</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">/*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">BN_set_word</span><span 
class="ec-lmtti-10x-x-90">(</span><span 
class="ec-lmtti-10x-x-90">t3</span><span 
class="ec-lmtti-10x-x-90">,7)</span><span 
class="ec-lmtti-10x-x-90">;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">just</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">have</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">to</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">miss</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115027r25"></a></span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">out</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">on</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">these</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">ones</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">:-(</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*/</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115028r26"></a><span 
class="ec-lmr-6">26</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">g</span><span 
class="ec-lmtt-9">=5;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115029r27"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">}</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115030r28"></a><span 
class="ec-lmr-6">28</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">else</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115031r29"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">{</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115032r30"></a><span 
class="ec-lmr-6">30</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">/*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">in</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">the</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">general</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">case</span><span 
class="ec-lmtti-10x-x-90">,</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">don</span><span 
class="ec-lmtti-10x-x-90">&#8217;</span><span 
class="ec-lmtti-10x-x-90">t</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">worry</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">if</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#8217;</span><span 
class="ec-lmtti-10x-x-90">generator</span><span 
class="ec-lmtti-10x-x-90">&#8217;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">is</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">a</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115033r31"></a></span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">generator</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">or</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">not</span><span 
class="ec-lmtti-10x-x-90">:</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">since</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">we</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">are</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">using</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">safe</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">primes</span><span 
class="ec-lmtti-10x-x-90">,</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115034r32"></a><span 
class="ec-lmr-6">32</span></span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">it</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">will</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">generate</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">either</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">an</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">order</span><span 
class="ec-lmtti-10x-x-90">-</span><span 
class="ec-lmtti-10x-x-90">q</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">or</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">an</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">order</span><span 
class="ec-lmtti-10x-x-90">-2</span><span 
class="ec-lmtti-10x-x-90">q</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">group</span><span 
class="ec-lmtti-10x-x-90">,</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115035r33"></a></span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">which</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">both</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">is</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">OK</span><span 
class="ec-lmtti-10x-x-90">&#x00A0;</span><span 
class="ec-lmtti-10x-x-90">*/</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115036r34"></a><span 
class="ec-lmr-6">34</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(!</span><span 
class="ec-lmtt-9">BN_set_word</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">t1</span><span 
class="ec-lmtt-9">,2)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115037r35"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">if</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">(!</span><span 
class="ec-lmtt-9">BN_set_word</span><span 
class="ec-lmtt-9">(</span><span 
class="ec-lmtt-9">t2</span><span 
class="ec-lmtt-9">,1)</span><span 
class="ec-lmtt-9">)</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtk-10x-x-90">goto</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">err</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115038r36"></a><span 
class="ec-lmr-6">36</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">g</span><span 
class="ec-lmtt-9">=</span><span 
class="ec-lmtt-9">generator</span><span 
class="ec-lmtt-9">;</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115039r37"></a></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">}</span><span 
class="ec-lmtt-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-115040r38"></a><span 
class="ec-lmr-6">38</span></span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span><span 
class="ec-lmtt-9">&#x00A0;</span>
   
   <br />
       <div class="caption" 
><span class="id">Listing&#x00A0;2.4:
       </span><span  
class="content">dh_gen.c</span></div><!--tex4ht:label?: x9-115001r2 -->
   </div>
<a 
 id="x9-115041r128"></a>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.2.4   </span> <a 
href="#x9-1160004" id="x9-1160004">Conclusion</a></h5>
     Ainsi selon la norme RFC-4419, le choix du générateur peut se résumer à un petit générateur qui ne serait pas
une racine primitive. La criticité du risque est très grande, car si deux personnes possèdent la même clef publique
                                                                                                  

                                                                                                  
pour deux clefs privées distinctes, ils pourront alors déchiffrer les messages, et signer à la place l&#8217;un de l&#8217;autre. Mais
la probabilité d&#8217;une telle collision est quasiment nulle, il est simplement deux fois plus efficace de générer deux clefs
privées possédant la même clef publique, que de retrouver la clef privée en brute force. OpenSSL laisse en plus
le choix au développeur de choisir une racine primitive comme générateur, pour des cas d&#8217;extrême
sécurité.
<a 
 id="x9-116001r125"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.3   </span> <a 
href="#x9-1170003" id="x9-1170003">Audit 2.3<span class="frenchb-nbsp">&nbsp;</span>: Diffie-Hellman Ephémère en mode FIPS</a></h4>
<a 
 id="x9-117001r132"></a>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.3.1   </span> <a 
href="#x9-1180001" id="x9-1180001">Normes visées</a></h5>
<!--l. 377--><p class="noindent" >Les normes visées sont les mêmes que celles de l&#8217;Audit 2.2 (cf. <a 
href="#x9-1110001">2.2.2.1<!--tex4ht:ref: audit2.2 --></a>).<br 
class="newline" />L&#8217;activation du mode FIPS entraîne l&#8217;utilisation des normes FIPS <span class="cite">[<a 
href="rapport_Auditli5.html#Xfips186-4">72</a>]</span> <span class="cite">[<a 
href="rapport_Auditli5.html#Xfips140-2">70</a>]</span>
<a 
 id="x9-118001r134"></a>
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.3.2   </span> <a 
href="#x9-1190002" id="x9-1190002">Description de la faille</a></h5>
<!--l. 382--><p class="noindent" >Une faille plus grave concerne le mode FIPS (Federal Information Processing Standard) d&#8217;OpenSSL, qui peut
être compilé avec la commande <span 
class="ec-lmtt-10x-x-109">./config fipscanisterbuild</span>". En effet, un attaquant situé entre
le client et le serveur connaissant la clef secrète du serveur peut déchiffrer une session SSL/TLS.
<br 
class="newline" />
</p><!--l. 384--><p class="indent" >   L&#8217;algorithme EDH/DHE (Diffie-Hellman Éphémère) permet de calculer une nouvelle clef connue
uniquement du client et du serveur, donc l&#8217;attaquant intermédiaire ne peut plus déchiffrer la session.
Cependant, en mode FIPS, OpenSSL ne rejette pas les paramètres P/Q faibles pour EDH/DHE.
Lorsque OpenSSL est compilé en mode FIPS, un attaquant en <span 
class="ec-lmri-10x-x-109">Man in the Middle </span>peut donc forcer la
génération d&#8217;un secret Diffie Hellman prédictible, en modifiant par exemple le traffic réseau. <span class="cite">[<a 
href="rapport_Auditli5.html#Xvigilance-vul-10585">74</a>]</span>
<span class="cite">[<a 
href="rapport_Auditli5.html#XCVE-2011-5095">42</a>]</span>.
</p><!--l. 386--><p class="indent" >   La faille en elle même n&#8217;est pas suffisante pour réaliser l&#8217;attaque, elle requiert également une implémentation
SSL faible.
<a 
 id="x9-119001r135"></a>
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.3.3   </span> <a 
href="#x9-1200003" id="x9-1200003">Implémentation</a></h5>
<!--l. 390--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1210003" id="x9-1210003"><span 
class="ec-lmbx-10x-x-109">Configuration vis</span><span 
class="ec-lmbx-10x-x-109">ée.</span><br 
class="newline" /></a></span>
   La version vulnérable d&#8217;OpenSSL est la 0.9.8, en mode FIPS uniquement.
</p>
<!--l. 394--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1220003" id="x9-1220003"><span 
class="ec-lmbx-10x-x-109">Fonction.</span><br 
class="newline" /></a></span>
   La fonction est accessible au chemin <span 
class="ec-lmtt-10x-x-109">openssl/crypto/dh/dh_key.c</span>. La figure <span 
class="ec-lmri-10x-x-109">Listing </span><a 
href="#x9-122001r5">2.5<!--tex4ht:ref: dhkey --></a> montre le <span 
class="ec-lmri-10x-x-109">diff </span>entre
les deux versions.
</p>
   <!--l. 398-->
                                                                                                  

                                                                                                  
<a 
 id="x9-122001r5"></a>
<a 
 id="x9-122002"></a>
<div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x9-122003r1"></a><span 
class="ec-lmr-6">1</span></span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">dh</span><span 
class="ec-lmr-9">/</span><span 
class="ec-lmr-9">dh_key</span><span 
class="ec-lmr-9">.</span><span 
class="ec-lmr-9">c</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="lmsy9-">-</span><span 
class="ec-lmr-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-122004r2"></a></span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="lmsy9-">-</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">if</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">(!</span><span 
class="ec-lmr-9">DH_check_pub_key</span><span 
class="ec-lmr-9">(</span><span 
class="ec-lmr-9">dh</span><span 
class="ec-lmr-9">,</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">pub_key</span><span 
class="ec-lmr-9">,</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&amp;</span><span 
class="ec-lmr-9">check_result</span><span 
class="ec-lmr-9">)</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">||</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">check_result</span><span 
class="ec-lmr-9">)</span><span 
class="ec-lmr-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-122005r3"></a><span 
class="ec-lmr-6">3</span></span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="lmsy9-">-</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">{</span><span 
class="ec-lmr-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-122006r4"></a></span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="lmsy9-">-</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">DHerr</span><span 
class="ec-lmr-9">(</span><span 
class="ec-lmr-9">DH_F_COMPUTE_KEY</span><span 
class="ec-lmr-9">,</span><span 
class="ec-lmr-9">DH_R_INVALID_PUBKEY</span><span 
class="ec-lmr-9">)</span><span 
class="ec-lmr-9">;</span><span 
class="ec-lmr-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-122007r5"></a><span 
class="ec-lmr-6">5</span></span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="lmsy9-">-</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">goto</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">err</span><span 
class="ec-lmr-9">;</span><span 
class="ec-lmr-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-122008r6"></a></span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="lmsy9-">-</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">}</span><span 
class="ec-lmr-9">&#x00A0;</span><br /><span class="label"><a 
 id="x9-122009r7"></a><span 
class="ec-lmr-6">7</span></span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span><span 
class="ec-lmr-9">&#x00A0;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;2.5:
    </span><span  
class="content">dh_key.c</span></div><!--tex4ht:label?: x9-122001r2 -->
   </div>
<!--l. 407--><p class="indent" >   Cette partie causait un faux positif sous certaines conditions pouvant fragiliser le système.
</p>
<!--l. 409--><p class="noindent" ><span class="paragraphHead"><a 
href="#x9-1230003" id="x9-1230003"><span 
class="ec-lmbx-10x-x-109">Solution logicielle.</span><br 
class="newline" /></a></span>
   Nessus Vulnerability Scanner est un logiciel permettant de tester la configuration du serveur afin d&#8217;identifier
entre autres de problèmes d&#8217;authentification <span class="cite">[<a 
href="rapport_Auditli5.html#Xnessus">62</a>]</span>. Le système RedHat préconise son utilisation pour savoir si cette
vulnérabilité concerne notre système.
<a 
 id="x9-123001r136"></a>
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.3.4   </span> <a 
href="#x9-1240004" id="x9-1240004">Conclusion</a></h5>
     Il est tout d&#8217;abord recommandé de passer à la version OpenSSL supérieure, sinon de désactiver le mode FIPS,
ou encore de configurer la <span 
class="ec-lmri-10x-x-109">ciphersuite </span>afin de ne pas permettre au serveur d&#8217;utiliser Diffie Hellman comme
algorithme d&#8217;échange de clefs.
                                                                                                  

                                                                                                  
                                                                                                  

                                                                                                  
                                                                                                  

                                                                                                  
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="rapport_Auditch5.html" >next</a>] [<a 
href="rapport_Auditch1.html" >prev</a>] [<a 
href="rapport_Auditch1.html#tailrapport_Auditch1.html" >prev-tail</a>] [<a 
href="rapport_Auditch2.html" >front</a>] [<a 
href="rapport_Audit.html#rapport_Auditch4.html" >up</a>] </p></div>
   <a 
 id="tailrapport_Auditch2.html"></a>               
</body></html> 
